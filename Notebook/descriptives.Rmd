# Descriptive statistics

Create list of covariates to be used in regression model.

```{r}
within(races, {
	year <- as.numeric(format(member_date, '%Y'))
	hours <- week1 + week2 + week3 + week4
	rating <- mm_rating
	maxrating <- mm_rating_max
	minrating <- mm_rating_min
	submissions <- mm_events
	avecodesub <- ave_nsub_past
	registrations <- mm_reg
#	svydate <- as.numeric(format(as.Date(startdate),"%d")) - 1
	lpaid  <- log(paid)
	male <- gender=='Male'
	grad <- educ == "Doctorate/PhD" | educ == "Postgraduate/Master of arts"
	below30 <- age == "<20 years old" | age== "20-25 years old" | age =="26-30 years"
}) -> dat

covars <- with(dat, data.frame(year, rating, volatility, maxrating, minrating, registrations, submissions, avecodesub, lpaid, nwins, ntop5, ntop10, risk, hours, male, timezone, grad, below30))
```

Check covariates are balanced across treatment groups. 

```{r}
# FUNC to compute descriptive statistics
descriptives <- function(dat, treat=races$treatment) {
	balance.test <- function(x) {
		l <- split(x, treat)
		kruskal.test(l)$p.val
	}
	mu <-sapply(dat, mean, na.rm=TRUE)
	q50 <-sapply(dat, median, na.rm=TRUE)
	lo <-sapply(dat, min, na.rm=TRUE)
	hi <-sapply(dat, max, na.rm=TRUE)
	std <-sapply(dat, sd, na.rm=TRUE)
	pval <- sapply(dat, balance.test)
	n <- sapply(dat, function(x) sum(!is.na(x)))
	tab <- cbind(mu, q50, std, lo, hi, n, pval)
	colnames(tab) <- c("Mean", "Median","St.Dev.", "Min", "Max", "Obs.", "P-value")
	return(tab)
}

tab <- descriptives(covars)
signif(tab, 2)
#xtab <- xtable(tab)
# digits(xtab) <- c(1, 1, rep(0, ncol(tab)-2), 3)
# align(xtab) <- c("@{}l", rep("r", ncol(tab)))
# caption(xtab) <- "Descriptive statistics"
# label(xtab) <- "summary"
# render.xtable(xtab)
```

Show skill rating distribution is the same across rooms

```{r}
colors <- c("brown", "dodgerblue", "orange")
boxplot(mm_rating ~ paste(treatment, room), data=races, col=rep(colors, each=8))
title("Skill rating distribution")
```

